<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AJHB - Dashboard Ejecutivo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --color-dorado: #8B7355;
            --color-platino: #B8B8B8;
            --color-negro: #0a0a0a;
            --color-card: #1a1a1a;
            --color-hover: #6B5344;
            --color-success: #2D5F3F;
            --color-warning: #8B6914;
            --color-error: #7D2E2E;
            --color-info: #2C4A6B;
            --color-royal-purple: #4A3B5C;
            --color-royal-blue: #2C3E5C;
            --color-burgundy: #5C3A3A;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: 
                radial-gradient(ellipse at top, rgba(74, 59, 92, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at bottom, rgba(44, 62, 92, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%);
            background-attachment: fixed;
            color: var(--color-platino);
            min-height: 100vh;
            padding: 2rem;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255, 255, 255, 0.01) 2px, rgba(255, 255, 255, 0.01) 4px);
            pointer-events: none;
            z-index: 1;
        }
        
        .header {
            background: 
                linear-gradient(145deg, rgba(26, 26, 26, 0.95), rgba(42, 42, 42, 0.95)),
                repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(74, 59, 92, 0.02) 10px, rgba(74, 59, 92, 0.02) 20px);
            border: 1px solid rgba(74, 59, 92, 0.4);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(184, 184, 184, 0.1) inset,
                0 2px 4px rgba(74, 59, 92, 0.2) inset;
            position: relative;
            z-index: 2;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(184, 184, 184, 0.3), transparent);
        }
        
        .header h1 {
            color: #E8E8E8;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-weight: 300;
            letter-spacing: 1px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .header p {
            color: var(--color-platino);
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: 
                linear-gradient(145deg, rgba(26, 26, 26, 0.9), rgba(42, 42, 42, 0.9)),
                repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(74, 59, 92, 0.02) 10px, rgba(74, 59, 92, 0.02) 20px);
            border: 1px solid rgba(74, 59, 92, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(184, 184, 184, 0.05) inset;
        }
        
        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(184, 184, 184, 0.05), transparent);
            transition: left 0.5s;
        }
        
        .stat-card:hover::after {
            left: 100%;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--color-royal-purple), var(--color-royal-blue));
        }
        
        .stat-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(74, 59, 92, 0.5),
                0 0 20px rgba(74, 59, 92, 0.2);
            border-color: rgba(74, 59, 92, 0.6);
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.05));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: var(--color-dorado);
            margin-bottom: 1rem;
        }
        
        .stat-value {
            font-size: 2.8rem;
            font-weight: 300;
            color: #E8E8E8;
            margin-bottom: 0.5rem;
            letter-spacing: 1px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
        }
        
        .stat-label {
            font-size: 0.95rem;
            color: var(--color-platino);
            opacity: 0.7;
            font-weight: 300;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-size: 0.75rem;
        }
        
        .stat-source {
            font-size: 0.75rem;
            color: var(--color-dorado);
            opacity: 0.6;
            margin-top: 0.5rem;
        }
        
        .section {
            background: 
                linear-gradient(145deg, rgba(26, 26, 26, 0.95), rgba(42, 42, 42, 0.95)),
                repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(74, 59, 92, 0.02) 10px, rgba(74, 59, 92, 0.02) 20px);
            border: 1px solid rgba(74, 59, 92, 0.3);
            border-radius: 15px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 
                0 10px 40px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(184, 184, 184, 0.05) inset;
            position: relative;
            z-index: 2;
        }
        
        .section-title {
            color: #E8E8E8;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: 
                linear-gradient(180deg, rgba(74, 59, 92, 0.15), rgba(74, 59, 92, 0.05));
            color: #D8D8D8;
            padding: 1rem 1.5rem;
            text-align: left;
            font-weight: 400;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-size: 0.85rem;
            border-bottom: 1px solid rgba(74, 59, 92, 0.4);
        }
        
        td {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid rgba(74, 59, 92, 0.08);
            color: var(--color-platino);
            font-weight: 300;
        }
        
        tr:hover {
            background: rgba(74, 59, 92, 0.05);
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .status-active {
            background: rgba(76, 175, 80, 0.2);
            color: var(--color-success);
            border: 1px solid var(--color-success);
        }
        
        .status-pending {
            background: rgba(255, 152, 0, 0.2);
            color: var(--color-warning);
            border: 1px solid var(--color-warning);
        }
        
        .status-error {
            background: rgba(244, 67, 54, 0.2);
            color: var(--color-error);
            border: 1px solid var(--color-error);
        }
        
        .loader {
            text-align: center;
            padding: 3rem;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(74, 59, 92, 0.1);
            border-top-color: var(--color-royal-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-message {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid var(--color-error);
            border-radius: 10px;
            padding: 1rem;
            color: var(--color-error);
            margin: 1rem 0;
        }
        
        .refresh-btn {
            background: linear-gradient(135deg, rgba(74, 59, 92, 0.8), rgba(44, 62, 92, 0.8));
            color: #E5E4E2;
            border: 1px solid rgba(184, 184, 184, 0.2);
            padding: 0.85rem 2rem;
            border-radius: 10px;
            font-weight: 400;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(184, 184, 184, 0.1) inset;
        }
        
        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(184, 184, 184, 0.2) inset,
                0 0 20px rgba(74, 59, 92, 0.3);
            background: linear-gradient(135deg, rgba(74, 59, 92, 1), rgba(44, 62, 92, 1));
        }
        
        .chart-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(74, 59, 92, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-royal-purple), var(--color-royal-blue));
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        /* ========== INTRO CINEMATOGR√ÅFICA ULTRA PREMIUM ========== */
        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000000;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            animation: fadeOutIntro 2s ease-out 9s forwards;
        }
        
        /* Fondo animado */
        .intro-background {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(74, 59, 92, 0.08) 0%, transparent 30%),
                radial-gradient(circle at 80% 70%, rgba(44, 62, 92, 0.06) 0%, transparent 30%),
                radial-gradient(circle at 50% 50%, rgba(92, 58, 58, 0.05) 0%, transparent 40%);
            animation: backgroundShift 8s ease-in-out infinite;
            z-index: 0;
        }
        
        @keyframes backgroundShift {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(2deg); }
        }
        
        @keyframes fadeOutIntro {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }
        
        /* Contenedor principal */
        .intro-content {
            position: relative;
            z-index: 5;
            text-align: center;
            transform: perspective(1000px);
        }
        
        /* Logo principal con efecto 3D */
        .intro-logo-container {
            position: relative;
            margin-bottom: 3rem;
        }
        
        .intro-logo {
            font-size: 9rem;
            font-weight: 100;
            letter-spacing: 30px;
            color: transparent;
            background: linear-gradient(135deg, #FFFFFF 0%, #9B8BA8 25%, #6B8CAE 50%, #9B8BA8 75%, #FFFFFF 100%);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            opacity: 0;
            transform: scale(0.3) rotateY(-180deg) rotateX(45deg);
            animation: logoEntrance 2.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) 1s forwards,
                       shimmer 4s ease-in-out 3.5s infinite;
            filter: drop-shadow(0 0 40px rgba(155, 139, 168, 0.6)) 
                    drop-shadow(0 0 80px rgba(107, 140, 174, 0.4));
            position: relative;
        }
        
        .intro-logo::before {
            content: 'AJHB';
            position: absolute;
            top: 0;
            left: 0;
            color: transparent;
            background: linear-gradient(135deg, rgba(155, 139, 168, 0.3), rgba(107, 140, 174, 0.3));
            -webkit-background-clip: text;
            background-clip: text;
            filter: blur(20px);
            z-index: -1;
        }
        
        @keyframes logoEntrance {
            0% {
                opacity: 0;
                transform: scale(0.5) rotateX(90deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotateX(0deg);
            }
        }
        
        @keyframes shimmer {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }
        
        /* Subt√≠tulo con efecto de m√°quina de escribir */
        .intro-subtitle {
            font-size: 1.5rem;
            font-weight: 300;
            letter-spacing: 8px;
            color: #B8B8B8;
            text-transform: uppercase;
            opacity: 0;
            transform: translateY(20px);
            animation: subtitleEntrance 1.5s ease-out 2s forwards;
            margin-bottom: 2rem;
        }
        
        @keyframes subtitleEntrance {
            0% {
                opacity: 0;
                transform: translateY(20px);
                letter-spacing: 0px;
            }
            100% {
                opacity: 1;
                transform: translateY(0);
                letter-spacing: 8px;
            }
        }
        
        /* Ornamento decorativo elegante */
        .intro-ornament {
            position: relative;
            width: 600px;
            height: 100px;
            margin: 3rem auto;
            opacity: 0;
            animation: fadeIn 1.5s ease-out 4s forwards;
        }
        
        .intro-ornament::before,
        .intro-ornament::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 45%;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(155, 139, 168, 0.6), transparent);
            transform: translateY(-50%);
        }
        
        .intro-ornament::before {
            left: 0;
            animation: slideInLeft 1.5s ease-out 4s forwards;
        }
        
        .intro-ornament::after {
            right: 0;
            animation: slideInRight 1.5s ease-out 4s forwards;
        }
        
        .intro-diamond {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, rgba(155, 139, 168, 0.4), rgba(107, 140, 174, 0.4));
            transform: translate(-50%, -50%) rotate(45deg) scale(0);
            animation: diamondPop 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) 4.5s forwards;
            box-shadow: 0 0 30px rgba(155, 139, 168, 0.6);
        }
        
        @keyframes slideInLeft {
            from {
                transform: translateY(-50%) translateX(-100px);
                opacity: 0;
            }
            to {
                transform: translateY(-50%) translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideInRight {
            from {
                transform: translateY(-50%) translateX(100px);
                opacity: 0;
            }
            to {
                transform: translateY(-50%) translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes diamondPop {
            0% {
                transform: translate(-50%, -50%) rotate(45deg) scale(0);
            }
            50% {
                transform: translate(-50%, -50%) rotate(225deg) scale(1.3);
            }
            100% {
                transform: translate(-50%, -50%) rotate(405deg) scale(1);
            }
        }
        
        /* Dashboard ejecutivo badge */
        .intro-badge {
            display: inline-block;
            padding: 0.75rem 2rem;
            border: 1px solid rgba(155, 139, 168, 0.3);
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 300;
            letter-spacing: 3px;
            color: #9B8BA8;
            text-transform: uppercase;
            opacity: 0;
            transform: scale(0.8);
            animation: badgeEntrance 1s cubic-bezier(0.34, 1.56, 0.64, 1) 4s forwards;
            box-shadow: 0 0 30px rgba(155, 139, 168, 0.2);
            margin-top: 2rem;
        }
        
        @keyframes badgeEntrance {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        /* Footer con cr√©ditos */
        .intro-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 2rem;
            text-align: center;
            opacity: 0;
            animation: fadeIn 1.5s ease-out 5s forwards;
            background: linear-gradient(0deg, rgba(0, 0, 0, 0.8) 0%, transparent 100%);
        }
        
        .intro-credits-top {
            font-size: 0.85rem;
            font-weight: 300;
            letter-spacing: 2px;
            color: #9B8BA8;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }
        
        .intro-company-name {
            font-size: 1.3rem;
            font-weight: 500;
            letter-spacing: 4px;
            color: #E8E8E8;
            margin: 0.75rem 0;
            text-transform: uppercase;
            text-shadow: 0 0 20px rgba(155, 139, 168, 0.6), 0 2px 4px rgba(0, 0, 0, 0.8);
            background: linear-gradient(135deg, #E8E8E8 0%, #B8B8B8 50%, #E8E8E8 100%);
            -webkit-background-clip: text;
            background-clip: text;
        }
        
        .intro-copyright {
            font-size: 0.75rem;
            font-weight: 300;
            letter-spacing: 1px;
            color: #9B8BA8;
            margin-top: 0.5rem;
            opacity: 0.85;
        }
        
        /* Part√≠culas mejoradas */
        .intro-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
        }
        
        .intro-particle {
            position: absolute;
            background: rgba(155, 139, 168, 0.4);
            border-radius: 50%;
        }
        
        .intro-particle.small {
            width: 2px;
            height: 2px;
            animation: floatParticleSmall 10s linear infinite;
        }
        
        .intro-particle.medium {
            width: 4px;
            height: 4px;
            animation: floatParticleMedium 12s linear infinite;
        }
        
        .intro-particle.large {
            width: 6px;
            height: 6px;
            animation: floatParticleLarge 15s linear infinite;
        }
        
        @keyframes floatParticleSmall {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-100vh) translateX(30px) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes floatParticleMedium {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.5;
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100vh) translateX(-40px) rotate(-360deg);
                opacity: 0;
            }
        }
        
        @keyframes floatParticleLarge {
            0% {
                transform: translateY(100vh) translateX(0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 0.4;
            }
            90% {
                opacity: 0.4;
            }
            100% {
                transform: translateY(-100vh) translateX(50px) scale(1);
                opacity: 0;
            }
        }
        
        /* Glow pulsante mejorado con anillos */
        .intro-glow {
            position: absolute;
            width: 1000px;
            height: 1000px;
            background: 
                radial-gradient(circle, rgba(74, 59, 92, 0.4) 0%, transparent 30%),
                radial-gradient(circle, transparent 30%, rgba(107, 140, 174, 0.2) 40%, transparent 50%),
                radial-gradient(circle, transparent 50%, rgba(92, 58, 58, 0.15) 60%, transparent 70%);
            border-radius: 50%;
            animation: pulseGlow 5s ease-in-out infinite;
            filter: blur(50px);
        }
        
        @keyframes pulseGlow {
            0%, 100% {
                transform: scale(1) rotate(0deg);
                opacity: 0.4;
            }
            50% {
                transform: scale(1.3) rotate(180deg);
                opacity: 0.7;
            }
        }
        
        /* Rayos de luz */
        .intro-rays {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            animation: fadeIn 2s ease-out 2s forwards;
        }
        
        .intro-ray {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 2px;
            height: 40%;
            background: linear-gradient(180deg, transparent, rgba(155, 139, 168, 0.2), transparent);
            transform-origin: top center;
            animation: rotateRay 20s linear infinite;
        }
        
        .intro-ray:nth-child(1) { transform: rotate(0deg); animation-delay: 0s; }
        .intro-ray:nth-child(2) { transform: rotate(45deg); animation-delay: -2.5s; }
        .intro-ray:nth-child(3) { transform: rotate(90deg); animation-delay: -5s; }
        .intro-ray:nth-child(4) { transform: rotate(135deg); animation-delay: -7.5s; }
        .intro-ray:nth-child(5) { transform: rotate(180deg); animation-delay: -10s; }
        .intro-ray:nth-child(6) { transform: rotate(225deg); animation-delay: -12.5s; }
        .intro-ray:nth-child(7) { transform: rotate(270deg); animation-delay: -15s; }
        .intro-ray:nth-child(8) { transform: rotate(315deg); animation-delay: -17.5s; }
        
        @keyframes rotateRay {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* Efecto de escaneo */
        .intro-scan {
            position: absolute;
            top: -100%;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, 
                transparent 0%, 
                rgba(155, 139, 168, 0.1) 50%, 
                transparent 100%);
            animation: scan 3s ease-in-out 1s infinite;
            pointer-events: none;
        }
        
        @keyframes scan {
            0% {
                top: -100%;
            }
            100% {
                top: 100%;
            }
        }
        
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- Intro Cinematogr√°fica Premium -->
    <div class="intro-overlay" id="introOverlay">
        <div class="intro-background"></div>
        <div class="intro-glow"></div>
        <div class="intro-rays">
            <div class="intro-ray"></div>
            <div class="intro-ray"></div>
            <div class="intro-ray"></div>
            <div class="intro-ray"></div>
            <div class="intro-ray"></div>
            <div class="intro-ray"></div>
            <div class="intro-ray"></div>
            <div class="intro-ray"></div>
        </div>
        <div class="intro-particles" id="introParticles"></div>
        <div class="intro-scan"></div>
        
        <div class="intro-content">
            <div class="intro-logo-container">
                <div class="intro-logo">AJHB</div>
            </div>
            
            <div class="intro-subtitle">Real Estate</div>
            
            <div class="intro-ornament">
                <div class="intro-diamond"></div>
            </div>
            
            <div class="intro-badge">Dashboard Ejecutivo</div>
        </div>
        
        <div class="intro-footer">
            <div class="intro-credits-top">Producido y Distribuido por</div>
            <div class="intro-company-name">Valorum Holdings Tech</div>
            <div class="intro-copyright">Todos los derechos reservados ¬© 2025</div>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <h1>
            <i class="fas fa-chart-line"></i>
            Dashboard Ejecutivo
        </h1>
        <p>Vista consolidada de Contadur√≠a y Ventas - AJHB Bienes Ra√≠ces</p>
        <button class="refresh-btn" onclick="loadAllData()" style="margin-top: 1rem;">
            <i class="fas fa-sync-alt"></i> Actualizar Datos
        </button>
    </div>

    <!-- ========== DEPARTAMENTO DE VENTAS ========== -->
    <div class="section">
        <div class="section-title" style="background: linear-gradient(135deg, rgba(74, 59, 92, 0.12), rgba(0, 0, 0, 0.4)); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; border-left: 3px solid rgba(74, 59, 92, 0.6);">
            <i class="fas fa-chart-line" style="color: #9B8BA8; opacity: 0.95;"></i>
            <span style="color: #B8B8B8; font-weight: 500; letter-spacing: 0.5px;">Departamento de Ventas</span>
        </div>
        
        <!-- M√©tricas de Ventas -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(74, 59, 92, 0.12), rgba(74, 59, 92, 0.04)); border: 1px solid rgba(74, 59, 92, 0.25);"><i class="fas fa-home" style="color: #9B8BA8;"></i></div>
                <div class="stat-value" id="totalProperties">-</div>
                <div class="stat-label">Propiedades Totales</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(74, 59, 92, 0.12), rgba(74, 59, 92, 0.04)); border: 1px solid rgba(74, 59, 92, 0.25);"><i class="fas fa-users" style="color: #9B8BA8;"></i></div>
                <div class="stat-value" id="ventasClients">-</div>
                <div class="stat-label">Clientes CRM</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(74, 59, 92, 0.12), rgba(74, 59, 92, 0.04)); border: 1px solid rgba(74, 59, 92, 0.25);"><i class="fas fa-file-contract" style="color: #9B8BA8;"></i></div>
                <div class="stat-value" id="totalContracts">-</div>
                <div class="stat-label">Contratos Activos</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(74, 59, 92, 0.12), rgba(74, 59, 92, 0.04)); border: 1px solid rgba(74, 59, 92, 0.25);"><i class="fas fa-dollar-sign" style="color: #9B8BA8;"></i></div>
                <div class="stat-value" id="ventasRevenue">‚Ç°0</div>
                <div class="stat-label">Ingresos por Ventas</div>
            </div>
        </div>
        
        <div class="two-column" style="margin-top: 2rem;">
            <div>
                <h3 style="color: #B8B8B8; margin-bottom: 1rem;">
                    <i class="fas fa-home"></i> Propiedades por Estado
                </h3>
                <div id="propertiesStatus">
                    <div class="loader">
                        <div class="spinner"></div>
                        <p>Cargando datos de ventas...</p>
                    </div>
                </div>
            </div>
            
            <div>
                <h3 style="color: #B8B8B8; margin-bottom: 1rem;">
                    <i class="fas fa-trophy"></i> Top 5 Propiedades
                </h3>
                <div id="topProperties">
                    <div class="loader">
                        <div class="spinner"></div>
                        <p>Cargando propiedades...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <h3 style="color: var(--color-dorado); margin: 2rem 0 1rem;">
            <i class="fas fa-handshake"></i> Contratos Recientes
        </h3>
        <div class="table-container" id="contractsTable">
            <div class="loader">
                <div class="spinner"></div>
                <p>Cargando contratos...</p>
            </div>
        </div>
    </div>

    <!-- ========== DEPARTAMENTO DE CONTADUR√çA ========== -->
    <div class="section">
        <div class="section-title" style="background: linear-gradient(135deg, rgba(44, 62, 92, 0.12), rgba(0, 0, 0, 0.4)); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; border-left: 3px solid rgba(44, 62, 92, 0.6);">
            <i class="fas fa-calculator" style="color: #6B8CAE; opacity: 0.95;"></i>
            <span style="color: #B8B8B8; font-weight: 500; letter-spacing: 0.5px;">Departamento de Contadur√≠a</span>
        </div>
        
        <!-- M√©tricas de Contadur√≠a -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(44, 62, 92, 0.12), rgba(44, 62, 92, 0.04)); border: 1px solid rgba(44, 62, 92, 0.25);"><i class="fas fa-hand-holding-usd" style="color: #6B8CAE;"></i></div>
                <div class="stat-value" id="cuentasCobrar">‚Ç°0</div>
                <div class="stat-label">Cuentas por Cobrar</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(44, 62, 92, 0.12), rgba(44, 62, 92, 0.04)); border: 1px solid rgba(44, 62, 92, 0.25);"><i class="fas fa-money-bill-wave" style="color: #6B8CAE;"></i></div>
                <div class="stat-value" id="cuentasPagar">‚Ç°0</div>
                <div class="stat-label">Cuentas por Pagar</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(44, 62, 92, 0.12), rgba(44, 62, 92, 0.04)); border: 1px solid rgba(44, 62, 92, 0.25);"><i class="fas fa-building" style="color: #6B8CAE;"></i></div>
                <div class="stat-value" id="totalActivos">-</div>
                <div class="stat-label">Activos Fijos</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(44, 62, 92, 0.12), rgba(44, 62, 92, 0.04)); border: 1px solid rgba(44, 62, 92, 0.25);"><i class="fas fa-book" style="color: #6B8CAE;"></i></div>
                <div class="stat-value" id="totalAsientos">-</div>
                <div class="stat-label">Asientos Contables</div>
            </div>
        </div>
        
        <div class="two-column" style="margin-top: 2rem;">
            <div>
                <h3 style="color: #B8B8B8; margin-bottom: 1rem;">
                    <i class="fas fa-chart-pie"></i> Estado Financiero
                </h3>
                <div id="financialStatus">
                    <div class="loader">
                        <div class="spinner"></div>
                        <p>Cargando datos contables...</p>
                    </div>
                </div>
            </div>
            
            <div>
                <h3 style="color: #B8B8B8; margin-bottom: 1rem;">
                    <i class="fas fa-exclamation-triangle"></i> Cuentas Vencidas
                </h3>
                <div id="overdueAccounts">
                    <div class="loader">
                        <div class="spinner"></div>
                        <p>Cargando cuentas...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <h3 style="color: var(--color-dorado); margin: 2rem 0 1rem;">
            <i class="fas fa-book"></i> Asientos Contables Recientes
        </h3>
        <div class="table-container" id="asientosTable">
            <div class="loader">
                <div class="spinner"></div>
                <p>Cargando asientos...</p>
            </div>
        </div>
    </div>

    <!-- ========== RESUMEN CONSOLIDADO ========== -->
    <div class="section" style="border: 2px solid rgba(92, 58, 58, 0.4); background: linear-gradient(145deg, rgba(92, 58, 58, 0.05), rgba(0, 0, 0, 0.5));">
        <div class="section-title" style="background: linear-gradient(135deg, rgba(92, 58, 58, 0.15), rgba(0, 0, 0, 0.4)); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; border-left: 3px solid rgba(92, 58, 58, 0.7);">
            <i class="fas fa-crown" style="color: #A67C7C; opacity: 0.95;"></i>
            <span style="color: #B8B8B8; font-weight: 600; letter-spacing: 0.8px; font-size: 1.05em;">Resumen Consolidado</span>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-value" id="totalClients">-</div>
                <div class="stat-label">Total Clientes</div>
                <div class="stat-source">Contadur√≠a + Ventas</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
                <div class="stat-value" id="totalRevenue">‚Ç°0</div>
                <div class="stat-label">Ingresos Totales</div>
                <div class="stat-source">Ventas + Cuentas por Cobrar</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-balance-scale"></i></div>
                <div class="stat-value" id="balanceNeto">‚Ç°0</div>
                <div class="stat-label">Balance Neto</div>
                <div class="stat-source">Por Cobrar - Por Pagar</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-chart-bar"></i></div>
                <div class="stat-value" id="totalOperaciones">-</div>
                <div class="stat-label">Total Operaciones</div>
                <div class="stat-source">Contratos + Asientos</div>
            </div>
        </div>
    </div>

    <script>
        // URLs de los backends
        const VENTAS_API = 'http://localhost:5001/api';
        const CONTA_API = 'http://localhost:5000/api';
        
        // Funci√≥n para formatear moneda
        function formatCurrency(amount) {
            return '‚Ç°' + parseFloat(amount || 0).toLocaleString('es-CR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }
        
        // Cargar datos de Ventas
        async function loadVentasData() {
            try {
                const [properties, clients, contracts] = await Promise.all([
                    fetch(`${VENTAS_API}/properties`).then(r => r.json()),
                    fetch(`${VENTAS_API}/clients`).then(r => r.json()),
                    fetch(`${VENTAS_API}/contracts`).then(r => r.json())
                ]);
                
                const propertiesData = properties.data || properties._0x4a5b || [];
                const clientsData = clients.data || clients._0x4a5b || [];
                const contractsData = contracts.data || contracts._0x4a5b || [];
                
                // Actualizar m√©tricas de Ventas
                document.getElementById('totalProperties').textContent = propertiesData.length;
                document.getElementById('ventasClients').textContent = clientsData.length;
                document.getElementById('totalContracts').textContent = contractsData.length;
                
                // Calcular ingresos de ventas
                const ventasRevenue = contractsData.reduce((sum, c) => sum + (c.value || 0), 0);
                document.getElementById('ventasRevenue').textContent = formatCurrency(ventasRevenue);
                
                // Mostrar propiedades por estado
                showPropertiesStatus(propertiesData);
                
                // Mostrar top propiedades
                showTopProperties(propertiesData);
                
                // Mostrar contratos recientes
                showRecentContracts(contractsData);
                
                return { propertiesData, clientsData, contractsData, ventasRevenue };
            } catch (error) {
                console.error('Error cargando datos de Ventas:', error);
                document.getElementById('propertiesStatus').innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        Error: Backend de Ventas no disponible (Puerto 5001)
                    </div>
                `;
                return { propertiesData: [], clientsData: [], contractsData: [], ventasRevenue: 0 };
            }
        }
        
        // Cargar datos de Contadur√≠a
        async function loadContaData() {
            try {
                const response = await fetch(`${CONTA_API}/stats/dashboard`);
                const stats = await response.json();
                
                // Actualizar m√©tricas
                document.getElementById('cuentasCobrar').textContent = formatCurrency(stats.cuentasCobrar || 0);
                document.getElementById('cuentasPagar').textContent = formatCurrency(stats.cuentasPagar || 0);
                document.getElementById('totalActivos').textContent = stats.totalActivos || 0;
                document.getElementById('totalAsientos').textContent = stats.totalAsientos || 0;
                
                // Cargar datos detallados
                const [cuentasCobrar, cuentasPagar, asientos] = await Promise.all([
                    fetch(`${CONTA_API}/cuentasPorCobrar`).then(r => r.json()),
                    fetch(`${CONTA_API}/cuentasPorPagar`).then(r => r.json()),
                    fetch(`${CONTA_API}/asientos`).then(r => r.json())
                ]);
                
                // Mostrar estado financiero
                showFinancialStatus(stats);
                
                // Mostrar cuentas vencidas
                showOverdueAccounts(cuentasCobrar, cuentasPagar);
                
                // Mostrar asientos recientes
                showRecentAsientos(asientos);
                
                return { stats, cuentasCobrar, cuentasPagar, asientos };
            } catch (error) {
                console.error('Error cargando datos de Contadur√≠a:', error);
                document.getElementById('financialStatus').innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        Error: Backend de Contadur√≠a no disponible (Puerto 5000)
                    </div>
                `;
                return { stats: {}, cuentasCobrar: [], cuentasPagar: [], asientos: [] };
            }
        }
        
        // Cargar todos los datos
        async function loadAllData() {
            console.log('üîÑ Cargando datos de ambos departamentos...');
            
            const [ventasData, contaData] = await Promise.all([
                loadVentasData(),
                loadContaData()
            ]);
            
            // ===== RESUMEN CONSOLIDADO =====
            // Consolidar clientes (Ventas + Contadur√≠a)
            const totalClients = (ventasData.clientsData?.length || 0) + (contaData.stats?.totalClientes || 0);
            document.getElementById('totalClients').textContent = totalClients;
            
            // Calcular ingresos totales
            const totalRevenue = ventasData.ventasRevenue + (contaData.stats?.cuentasCobrar || 0);
            document.getElementById('totalRevenue').textContent = formatCurrency(totalRevenue);
            
            // Balance neto
            const balanceNeto = (contaData.stats?.cuentasCobrar || 0) - (contaData.stats?.cuentasPagar || 0);
            document.getElementById('balanceNeto').textContent = formatCurrency(balanceNeto);
            
            // Total operaciones
            const totalOperaciones = (ventasData.contractsData?.length || 0) + (contaData.stats?.totalAsientos || 0);
            document.getElementById('totalOperaciones').textContent = totalOperaciones;
            
            console.log('‚úÖ Datos cargados correctamente');
        }
        
        // Mostrar propiedades por estado
        function showPropertiesStatus(properties) {
            const statusCount = {
                disponible: 0,
                reservada: 0,
                vendida: 0,
                'en-proceso': 0
            };
            
            properties.forEach(p => {
                const status = (p.status || 'disponible').toLowerCase();
                if (statusCount.hasOwnProperty(status)) {
                    statusCount[status]++;
                }
            });
            
            const total = properties.length || 1;
            
            document.getElementById('propertiesStatus').innerHTML = `
                <div style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>Disponibles</span>
                        <strong style="color: var(--color-success);">${statusCount.disponible}</strong>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${(statusCount.disponible / total * 100)}%; background: var(--color-success);"></div>
                    </div>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>Reservadas</span>
                        <strong style="color: var(--color-warning);">${statusCount.reservada}</strong>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${(statusCount.reservada / total * 100)}%; background: var(--color-warning);"></div>
                    </div>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>Vendidas</span>
                        <strong style="color: var(--color-dorado);">${statusCount.vendida}</strong>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${(statusCount.vendida / total * 100)}%;"></div>
                    </div>
                </div>
                
                <div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>En Proceso</span>
                        <strong style="color: var(--color-info);">${statusCount['en-proceso']}</strong>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${(statusCount['en-proceso'] / total * 100)}%; background: var(--color-info);"></div>
                    </div>
                </div>
            `;
        }
        
        // Mostrar top propiedades
        function showTopProperties(properties) {
            const sorted = properties.sort((a, b) => (b.price || 0) - (a.price || 0)).slice(0, 5);
            
            if (sorted.length === 0) {
                document.getElementById('topProperties').innerHTML = '<p style="text-align: center; opacity: 0.6;">No hay propiedades registradas</p>';
                return;
            }
            
            document.getElementById('topProperties').innerHTML = sorted.map((p, i) => `
                <div style="padding: 1rem; background: rgba(255, 215, 0, 0.05); border-radius: 8px; margin-bottom: 0.75rem; border-left: 3px solid var(--color-dorado);">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 600; color: var(--color-dorado);">#${i + 1} ${p.address || 'Sin direcci√≥n'}</div>
                            <div style="font-size: 0.85rem; opacity: 0.8;">${p.type || 'N/A'} - ${p.area || 0}m¬≤</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: var(--color-dorado);">${formatCurrency(p.price)}</div>
                            <div style="font-size: 0.75rem; opacity: 0.6;">${p.status || 'Disponible'}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Mostrar contratos recientes
        function showRecentContracts(contracts) {
            const recent = contracts.slice(0, 10);
            
            if (recent.length === 0) {
                document.getElementById('contractsTable').innerHTML = '<p style="text-align: center; opacity: 0.6; padding: 2rem;">No hay contratos registrados</p>';
                return;
            }
            
            document.getElementById('contractsTable').innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Cliente</th>
                            <th>Propiedad</th>
                            <th>Tipo</th>
                            <th>Valor</th>
                            <th>Fecha</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${recent.map(c => `
                            <tr>
                                <td>#${c.id}</td>
                                <td>${c.clientName || 'N/A'}</td>
                                <td>${c.propertyInfo || 'N/A'}</td>
                                <td>${c.type || 'N/A'}</td>
                                <td>${formatCurrency(c.value)}</td>
                                <td>${c.date || 'N/A'}</td>
                                <td><span class="status-badge status-active">${c.status || 'Activo'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }
        
        // Mostrar estado financiero
        function showFinancialStatus(stats) {
            const cobrar = stats.cuentasCobrar || 0;
            const pagar = stats.cuentasPagar || 0;
            const balance = cobrar - pagar;
            
            document.getElementById('financialStatus').innerHTML = `
                <div style="margin-bottom: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span><i class="fas fa-arrow-up" style="color: var(--color-success);"></i> Por Cobrar</span>
                        <strong style="color: var(--color-success);">${formatCurrency(cobrar)}</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span><i class="fas fa-arrow-down" style="color: var(--color-error);"></i> Por Pagar</span>
                        <strong style="color: var(--color-error);">${formatCurrency(pagar)}</strong>
                    </div>
                    <hr style="border: 1px solid rgba(255, 215, 0, 0.2); margin: 1rem 0;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-weight: 600;">Balance Neto</span>
                        <strong style="color: ${balance >= 0 ? 'var(--color-success)' : 'var(--color-error)'}; font-size: 1.3rem;">
                            ${formatCurrency(balance)}
                        </strong>
                    </div>
                </div>
                
                <div style="background: rgba(255, 215, 0, 0.05); padding: 1rem; border-radius: 8px; border-left: 3px solid var(--color-dorado);">
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        <div style="margin-bottom: 0.5rem;">
                            <i class="fas fa-building"></i> Activos Fijos: <strong>${stats.totalActivos || 0}</strong>
                        </div>
                        <div style="margin-bottom: 0.5rem;">
                            <i class="fas fa-book"></i> Asientos: <strong>${stats.totalAsientos || 0}</strong>
                        </div>
                        <div>
                            <i class="fas fa-users"></i> Clientes: <strong>${stats.totalClientes || 0}</strong>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Mostrar cuentas vencidas
        function showOverdueAccounts(cuentasCobrar, cuentasPagar) {
            const today = new Date();
            const vencidasCobrar = cuentasCobrar.filter(c => 
                c.estado !== 'pagada' && new Date(c.fechaVencimiento) < today
            );
            const vencidasPagar = cuentasPagar.filter(c => 
                c.estado !== 'pagada' && new Date(c.fechaVencimiento) < today
            );
            
            const totalVencidas = vencidasCobrar.length + vencidasPagar.length;
            
            if (totalVencidas === 0) {
                document.getElementById('overdueAccounts').innerHTML = `
                    <div style="text-align: center; padding: 2rem; background: rgba(76, 175, 80, 0.1); border-radius: 8px; border: 1px solid var(--color-success);">
                        <i class="fas fa-check-circle" style="font-size: 3rem; color: var(--color-success); margin-bottom: 1rem;"></i>
                        <div style="color: var(--color-success); font-weight: 600;">¬°Sin cuentas vencidas!</div>
                        <div style="font-size: 0.85rem; opacity: 0.8; margin-top: 0.5rem;">Todas las cuentas est√°n al d√≠a</div>
                    </div>
                `;
                return;
            }
            
            document.getElementById('overdueAccounts').innerHTML = `
                <div style="background: rgba(244, 67, 54, 0.1); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--color-error);">
                    <div style="text-align: center; margin-bottom: 1rem;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2.5rem; color: var(--color-error);"></i>
                    </div>
                    <div style="text-align: center; font-size: 1.5rem; font-weight: 700; color: var(--color-error); margin-bottom: 1rem;">
                        ${totalVencidas} Cuentas Vencidas
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 0.85rem; opacity: 0.8;">Por Cobrar</div>
                            <div style="font-size: 1.3rem; font-weight: 600; color: var(--color-error);">${vencidasCobrar.length}</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.85rem; opacity: 0.8;">Por Pagar</div>
                            <div style="font-size: 1.3rem; font-weight: 600; color: var(--color-error);">${vencidasPagar.length}</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Mostrar asientos recientes
        function showRecentAsientos(asientos) {
            const recent = asientos.slice(0, 10);
            
            if (recent.length === 0) {
                document.getElementById('asientosTable').innerHTML = '<p style="text-align: center; opacity: 0.6; padding: 2rem;">No hay asientos registrados</p>';
                return;
            }
            
            document.getElementById('asientosTable').innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>N√∫mero</th>
                            <th>Fecha</th>
                            <th>Tipo</th>
                            <th>Descripci√≥n</th>
                            <th>Debe</th>
                            <th>Haber</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${recent.map(a => `
                            <tr>
                                <td>${a.numero || 'N/A'}</td>
                                <td>${a.fecha || 'N/A'}</td>
                                <td>${a.tipo || 'N/A'}</td>
                                <td>${a.descripcion || 'N/A'}</td>
                                <td>${formatCurrency(a.totalDebe)}</td>
                                <td>${formatCurrency(a.totalHaber)}</td>
                                <td><span class="status-badge status-active">${a.estado || 'Activo'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }
        
        // ===== INTRO CINEMATOGR√ÅFICA PREMIUM =====
        function createIntroParticles() {
            const container = document.getElementById('introParticles');
            const particleCounts = {
                small: 40,
                medium: 20,
                large: 10
            };
            
            // Crear part√≠culas peque√±as
            for (let i = 0; i < particleCounts.small; i++) {
                const particle = document.createElement('div');
                particle.className = 'intro-particle small';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                container.appendChild(particle);
            }
            
            // Crear part√≠culas medianas
            for (let i = 0; i < particleCounts.medium; i++) {
                const particle = document.createElement('div');
                particle.className = 'intro-particle medium';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 12 + 's';
                container.appendChild(particle);
            }
            
            // Crear part√≠culas grandes
            for (let i = 0; i < particleCounts.large; i++) {
                const particle = document.createElement('div');
                particle.className = 'intro-particle large';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                container.appendChild(particle);
            }
        }
        
        // Remover intro despu√©s de la animaci√≥n (11 segundos)
        setTimeout(() => {
            const intro = document.getElementById('introOverlay');
            if (intro) {
                intro.remove();
            }
        }, 11000);
        
        // Cargar datos al iniciar
        window.addEventListener('load', () => {
            console.log('üé¨ Iniciando intro cinematogr√°fica ultra premium...');
            createIntroParticles();
            
            setTimeout(() => {
                console.log('üìä Dashboard Ejecutivo iniciado');
                loadAllData();
                loadEmpleados();
            }, 7000);
            
            // Actualizar cada 30 segundos
            setInterval(loadAllData, 30000);
        });
    </script>
    
    <!-- Panel de Gesti√≥n de Empleados -->
    <div id="panel-empleados" style="display: none; position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
        <button onclick="togglePanelEmpleados()" style="
            background: linear-gradient(135deg, #FFD700, #FFC107);
            color: #0a0a0a;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.5);
            transition: all 0.3s;
        " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            <i class="fas fa-users-cog"></i> Gestionar Empleados
        </button>
    </div>
    
    <!-- Modal Gesti√≥n de Empleados -->
    <div id="modal-empleados" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: linear-gradient(145deg, #1a1a1a, #2a2a2a); border: 2px solid #FFD700; border-radius: 20px; padding: 2rem; max-width: 1200px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255, 215, 0, 0.3);">
                <h2 style="color: #FFD700; font-size: 1.8rem;">
                    <i class="fas fa-users-cog"></i> Gesti√≥n de Empleados
                </h2>
                <button onclick="closePanelEmpleados()" style="background: none; border: none; color: #E5E4E2; font-size: 1.5rem; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Bot√≥n Agregar Empleado -->
            <button onclick="openNuevoEmpleado()" style="
                background: linear-gradient(135deg, #FFD700, #FFC107);
                color: #0a0a0a;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 10px;
                font-weight: 600;
                cursor: pointer;
                margin-bottom: 2rem;
                box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            ">
                <i class="fas fa-user-plus"></i> Agregar Nuevo Empleado
            </button>
            
            <!-- Lista de Empleados -->
            <div id="lista-empleados" style="display: grid; gap: 1rem;">
                <div style="text-align: center; padding: 3rem; color: #E5E4E2; opacity: 0.6;">
                    <i class="fas fa-users" style="font-size: 3rem; color: #FFD700; margin-bottom: 1rem;"></i>
                    <p>Cargando empleados...</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Nuevo/Editar Empleado -->
    <div id="modal-empleado-form" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 10001; align-items: center; justify-content: center;">
        <div style="background: linear-gradient(145deg, #1a1a1a, #2a2a2a); border: 2px solid #FFD700; border-radius: 20px; padding: 2rem; max-width: 600px; width: 90%;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255, 215, 0, 0.3);">
                <h3 style="color: #FFD700; font-size: 1.5rem;" id="form-empleado-title">Nuevo Empleado</h3>
                <button onclick="closeFormEmpleado()" style="background: none; border: none; color: #E5E4E2; font-size: 1.5rem; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="form-empleado" onsubmit="saveEmpleado(event)">
                <input type="hidden" id="empleado-id">
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; color: #FFD700; margin-bottom: 0.5rem;">Usuario</label>
                    <input type="text" id="empleado-username" required style="width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.5); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 8px; color: #E5E4E2; font-size: 1rem;">
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; color: #FFD700; margin-bottom: 0.5rem;">Contrase√±a</label>
                    <input type="password" id="empleado-password" required style="width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.5); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 8px; color: #E5E4E2; font-size: 1rem;">
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; color: #FFD700; margin-bottom: 0.5rem;">Nombre Completo</label>
                    <input type="text" id="empleado-nombre" required style="width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.5); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 8px; color: #E5E4E2; font-size: 1rem;">
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; color: #FFD700; margin-bottom: 0.5rem;">Email</label>
                    <input type="email" id="empleado-email" style="width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.5); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 8px; color: #E5E4E2; font-size: 1rem;">
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; color: #FFD700; margin-bottom: 0.5rem;">Rol</label>
                    <select id="empleado-role" required onchange="updatePermisos()" style="width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.5); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 8px; color: #E5E4E2; font-size: 1rem;">
                        <option value="">Seleccionar rol...</option>
                        <option value="agente_ventas">Agente de Ventas</option>
                        <option value="secretario">Secretario</option>
                        <option value="contador">Contador</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; color: #FFD700; margin-bottom: 0.5rem;">Permisos de Acceso</label>
                    <div id="permisos-container" style="background: rgba(0, 0, 0, 0.3); padding: 1rem; border-radius: 8px; border: 1px solid rgba(255, 215, 0, 0.2);">
                        <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; color: #E5E4E2; cursor: pointer;">
                            <input type="checkbox" id="perm-ventas" value="ventas" style="width: 18px; height: 18px;">
                            <span>Departamento de Ventas</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; color: #E5E4E2; cursor: pointer;">
                            <input type="checkbox" id="perm-secretarios" value="secretarios" style="width: 18px; height: 18px;">
                            <span>Departamento de Secretarios</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; color: #E5E4E2; cursor: pointer;">
                            <input type="checkbox" id="perm-contaduria" value="contaduria" style="width: 18px; height: 18px;">
                            <span>Departamento de Contadur√≠a</span>
                        </label>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem;">
                    <button type="submit" style="flex: 1; background: linear-gradient(135deg, #FFD700, #FFC107); color: #0a0a0a; border: none; padding: 0.75rem; border-radius: 10px; font-weight: 600; cursor: pointer;">
                        <i class="fas fa-save"></i> Guardar Empleado
                    </button>
                    <button type="button" onclick="deleteEmpleadoFromForm()" id="btn-delete-empleado" style="display: none; background: rgba(220, 38, 38, 0.8); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 10px; font-weight: 600; cursor: pointer;">
                        <i class="fas fa-trash"></i> Eliminar
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // ===== GESTI√ìN DE EMPLEADOS =====
        
        function togglePanelEmpleados() {
            const modal = document.getElementById('modal-empleados');
            modal.style.display = modal.style.display === 'none' ? 'flex' : 'none';
            if (modal.style.display === 'flex') {
                loadEmpleados();
            }
        }
        
        function closePanelEmpleados() {
            document.getElementById('modal-empleados').style.display = 'none';
        }
        
        function openNuevoEmpleado() {
            document.getElementById('form-empleado-title').textContent = 'Nuevo Empleado';
            document.getElementById('empleado-id').value = '';
            document.getElementById('form-empleado').reset();
            document.getElementById('btn-delete-empleado').style.display = 'none';
            document.getElementById('modal-empleado-form').style.display = 'flex';
        }
        
        function closeFormEmpleado() {
            document.getElementById('modal-empleado-form').style.display = 'none';
        }
        
        function updatePermisos() {
            const role = document.getElementById('empleado-role').value;
            const permVentas = document.getElementById('perm-ventas');
            const permSecretarios = document.getElementById('perm-secretarios');
            const permContaduria = document.getElementById('perm-contaduria');
            
            // Limpiar
            permVentas.checked = false;
            permSecretarios.checked = false;
            permContaduria.checked = false;
            
            // Asignar permisos seg√∫n rol
            if (role === 'agente_ventas') {
                permVentas.checked = true;
            } else if (role === 'secretario') {
                permVentas.checked = true;
                permSecretarios.checked = true;
            } else if (role === 'contador') {
                permContaduria.checked = true;
            }
        }
        
        async function loadEmpleados() {
            try {
                const token = localStorage.getItem('ajhb_token');
                const response = await fetch('http://localhost:5003/api/users', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (!response.ok) return;
                
                const data = await response.json();
                if (!data.success) return;
                
                const lista = document.getElementById('lista-empleados');
                
                if (data.data.length === 0) {
                    lista.innerHTML = '<div style="text-align: center; padding: 3rem; color: #E5E4E2; opacity: 0.6;"><i class="fas fa-users" style="font-size: 3rem; color: #FFD700; margin-bottom: 1rem;"></i><p>No hay empleados registrados</p></div>';
                    return;
                }
                
                lista.innerHTML = data.data.map(emp => `
                    <div style="background: rgba(0, 0, 0, 0.5); padding: 1.5rem; border-radius: 10px; border: 1px solid rgba(255, 215, 0, 0.3); display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h4 style="color: #FFD700; margin-bottom: 0.5rem;">${emp.nombre_completo}</h4>
                            <p style="color: #E5E4E2; font-size: 0.9rem; opacity: 0.8;">@${emp.username} ‚Ä¢ ${getRoleLabel(emp.role)}</p>
                            <p style="color: #E5E4E2; font-size: 0.85rem; opacity: 0.6; margin-top: 0.25rem;">Permisos: ${emp.permisos}</p>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button onclick="editEmpleado(${emp.id})" style="background: rgba(255, 215, 0, 0.2); border: 1px solid #FFD700; color: #FFD700; padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer;">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            ${emp.role !== 'director' ? `
                            <button onclick="desactivarEmpleado(${emp.id})" style="background: rgba(220, 38, 38, 0.2); border: 1px solid #F44336; color: #F87171; padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer;">
                                <i class="fas fa-user-slash"></i> Desactivar
                            </button>
                            ` : ''}
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error al cargar empleados:', error);
            }
        }
        
        function getRoleLabel(role) {
            const labels = {
                'director': 'Director Ejecutivo',
                'agente_ventas': 'Agente de Ventas',
                'secretario': 'Secretario',
                'contador': 'Contador'
            };
            return labels[role] || role;
        }
        
        async function saveEmpleado(event) {
            event.preventDefault();
            
            const empleadoId = document.getElementById('empleado-id').value;
            const passwordField = document.getElementById('empleado-password').value;
            const permisos = [];
            if (document.getElementById('perm-ventas').checked) permisos.push('ventas');
            if (document.getElementById('perm-secretarios').checked) permisos.push('secretarios');
            if (document.getElementById('perm-contaduria').checked) permisos.push('contaduria');
            
            const empleado = {
                username: document.getElementById('empleado-username').value,
                nombre_completo: document.getElementById('empleado-nombre').value,
                email: document.getElementById('empleado-email').value,
                role: document.getElementById('empleado-role').value,
                permisos: permisos.join(',')
            };
            
            // Solo incluir password si se ingres√≥ una nueva (al crear o al editar con cambio)
            if (passwordField && passwordField.trim() !== '') {
                empleado.password = passwordField;
            }
            
            try {
                const token = localStorage.getItem('ajhb_token');
                const url = empleadoId ? `http://localhost:5003/api/users/${empleadoId}` : 'http://localhost:5003/api/users';
                const method = empleadoId ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(empleado)
                });
                
                if (response.ok) {
                    alert(empleadoId ? '‚úÖ Empleado actualizado correctamente' : '‚úÖ Empleado creado exitosamente');
                    closeFormEmpleado();
                    loadEmpleados();
                } else {
                    const error = await response.json();
                    alert('‚ùå Error: ' + (error.error || 'No se pudo guardar'));
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‚ùå Error de conexi√≥n');
            }
        }
        
        async function editEmpleado(id) {
            try {
                const token = localStorage.getItem('ajhb_token');
                const response = await fetch('http://localhost:5003/api/users', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                const data = await response.json();
                const empleado = data.data.find(e => e.id === id);
                
                if (empleado) {
                    document.getElementById('form-empleado-title').textContent = 'Editar Empleado';
                    document.getElementById('empleado-id').value = empleado.id;
                    document.getElementById('empleado-username').value = empleado.username;
                    document.getElementById('empleado-password').value = '';
                    document.getElementById('empleado-password').required = false;
                    document.getElementById('empleado-nombre').value = empleado.nombre_completo;
                    document.getElementById('empleado-email').value = empleado.email || '';
                    document.getElementById('empleado-role').value = empleado.role;
                    
                    // Permisos
                    const permisos = empleado.permisos.split(',');
                    document.getElementById('perm-ventas').checked = permisos.includes('ventas');
                    document.getElementById('perm-secretarios').checked = permisos.includes('secretarios');
                    document.getElementById('perm-contaduria').checked = permisos.includes('contaduria');
                    
                    document.getElementById('btn-delete-empleado').style.display = 'block';
                    document.getElementById('modal-empleado-form').style.display = 'flex';
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }
        
        async function desactivarEmpleado(id) {
            if (!confirm('¬øEst√° seguro de desactivar este empleado? No podr√° acceder al sistema.')) return;
            
            try {
                const token = localStorage.getItem('ajhb_token');
                const response = await fetch(`http://localhost:5003/api/users/${id}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    alert('‚úÖ Empleado desactivado');
                    loadEmpleados();
                } else {
                    alert('‚ùå Error al desactivar empleado');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‚ùå Error de conexi√≥n');
            }
        }
        
        async function deleteEmpleadoFromForm() {
            const id = document.getElementById('empleado-id').value;
            if (!id) return;
            
            if (!confirm('¬øEst√° seguro de eliminar este empleado permanentemente?')) return;
            
            try {
                const token = localStorage.getItem('ajhb_token');
                const response = await fetch(`http://localhost:5003/api/users/${id}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    alert('‚úÖ Empleado eliminado');
                    closeFormEmpleado();
                    loadEmpleados();
                } else {
                    alert('‚ùå Error al eliminar empleado');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‚ùå Error de conexi√≥n');
            }
        }
        
        // ===== ALERTA PERSONALIZADA =====
        function mostrarAlertaAccesoDenegado(modulo){const o=document.createElement('div');o.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:999999;display:flex;align-items:center;justify-content:center';const m=document.createElement('div');m.style.cssText='background:linear-gradient(145deg,#1a1a1a,#2a2a2a);border:3px solid #dc2626;border-radius:20px;padding:3rem;max-width:500px;text-align:center;box-shadow:0 20px 60px rgba(220,38,38,0.5)';m.innerHTML=`<div style="width:100px;height:100px;margin:0 auto 1.5rem;background:linear-gradient(135deg,#dc2626,#991b1b);border-radius:50%;display:flex;align-items:center;justify-content:center"><i class="fas fa-shield-alt" style="font-size:3rem;color:white"></i></div><h2 style="color:#dc2626;font-size:2rem;margin-bottom:1rem;font-weight:700">‚õî Acceso Denegado</h2><p style="color:#E5E4E2;font-size:1.1rem;margin-bottom:1.5rem">Solo el Director Ejecutivo puede acceder a:<br><strong style="color:#FFD700;font-size:1.3rem">${modulo}</strong></p><button onclick="window.location.href='homeajhb.html'" style="background:linear-gradient(135deg,#FFD700,#FFC107);color:#0a0a0a;border:none;padding:1rem 2.5rem;border-radius:12px;font-size:1.1rem;font-weight:700;cursor:pointer"><i class="fas fa-home"></i> Volver</button>`;o.appendChild(m);document.body.appendChild(o);}
        
        // ===== PROTECCI√ìN DE AUTENTICACI√ìN =====
        (async function verificarAcceso() {
            const token = localStorage.getItem('ajhb_token');
            const userData = localStorage.getItem('ajhb_user');
            
            if (!token || !userData) {
                console.log('‚ùå Acceso denegado: No hay sesi√≥n activa');
                window.location.href = 'login1.html';
                return;
            }
            
            try {
                const user = JSON.parse(userData);
                
                // Solo el director puede acceder
                if (user.role !== 'director') {
                    console.log('‚ùå Acceso denegado: Solo para Director Ejecutivo');
                    mostrarAlertaAccesoDenegado('Dashboard Ejecutivo');
                    return;
                }
                
                // Verificar token con backend
                const response = await fetch('http://localhost:5003/api/verify', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (!response.ok || !(await response.json()).valid) {
                    console.log('‚ùå Token inv√°lido');
                    localStorage.removeItem('ajhb_token');
                    localStorage.removeItem('ajhb_user');
                    window.location.href = 'login1.html';
                    return;
                }
                
                console.log('‚úÖ Acceso autorizado a Dashboard Ejecutivo');
            } catch (error) {
                console.error('‚ùå Error al verificar acceso:', error);
                window.location.href = 'login1.html';
            }
        })();
        
        // Mostrar bot√≥n solo despu√©s de la intro
        setTimeout(() => {
            document.getElementById('panel-empleados').style.display = 'block';
        }, 11000);
    </script>
</body>
</html>
